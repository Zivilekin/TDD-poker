"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var chai_1 = require("chai");
var generate_test_util_1 = require("../utils/generate-test-util");
describe('Stylable postcss transform (Global)', function () {
    it('should support :global()', function () {
        var result = generate_test_util_1.generateStylableRoot({
            entry: "/a/b/style.st.css",
            files: {
                '/a/b/style.st.css': {
                    namespace: 'style',
                    content: "\n                        .root :global(.btn) {}\n                        :global(.btn) {}\n                        :global(.btn) .container {}\n                    "
                }
            }
        });
        chai_1.expect(result.nodes[0].selector).to.equal('.style--root .btn');
        chai_1.expect(result.nodes[1].selector).to.equal('.btn');
        chai_1.expect(result.nodes[2].selector).to.equal('.btn .style--container');
    });
    it('should support :global() as mixin', function () {
        var result = generate_test_util_1.generateStylableRoot({
            entry: "/style.st.css",
            files: {
                '/style.st.css': {
                    namespace: 'style',
                    content: "\n                        :import {\n                            -st-from: \"./comp.st.css\";\n                            -st-default: Comp;\n                        }\n                        .root {\n                            -st-mixin: Comp;\n                        }\n                    "
                },
                '/comp.st.css': {
                    namespace: 'comp',
                    content: "\n                        :global(.btn) .root {}\n                    "
                }
            }
        });
        chai_1.expect(result.nodes[1].selector).to.equal('.btn .style--root');
    });
    it('should support nested :global() as mixin', function () {
        var result = generate_test_util_1.generateStylableRoot({
            entry: "/style.st.css",
            files: {
                '/style.st.css': {
                    namespace: 'style',
                    content: "\n                        :import {\n                            -st-from: \"./mixin.st.css\";\n                            -st-default: Mixin;\n                        }\n                        .root {\n                            -st-mixin: Mixin;\n                        }\n                    "
                },
                '/mixin.st.css': {
                    namespace: 'mixin',
                    content: "\n                        :import {\n                            -st-from: \"./comp.st.css\";\n                            -st-default: Comp;\n                        }\n                        .root {\n                            -st-mixin: Comp;\n                        }\n                    "
                },
                '/comp.st.css': {
                    namespace: 'comp',
                    content: "\n                        :global(.btn) .root {}\n                    "
                }
            }
        });
        chai_1.expect(result.nodes[1].selector).to.equal('.btn .style--root');
    });
    it('should register to all global classes to "meta.globals"', function () {
        var meta = generate_test_util_1.generateStylableResult({
            entry: "/style.st.css",
            files: {
                '/style.st.css': {
                    namespace: 'style',
                    content: "\n                        :import {\n                            -st-from: \"./mixin.st.css\";\n                            -st-named: test, mix;\n                        }\n                        .root {}\n                        .test {}\n                        .x { -st-global: '.a .b'; }\n                        :global(.c .d) {}\n                        :global(.e) {}\n                        .mixIntoMe { -st-mixin: mix; }\n                    "
                },
                '/mixin.st.css': {
                    namespace: 'mixin',
                    content: "\n                        .test {\n                            -st-global: \".global-test\";\n                        }\n\n                        .mix :global(.global-test2) {}\n                    "
                }
            }
        }).meta;
        chai_1.expect(meta.globals).to.eql({
            'global-test': true,
            'global-test2': true,
            'a': true,
            'b': true,
            'c': true,
            'd': true,
            'e': true
        });
        chai_1.expect(meta.outputAst.nodes[1].selector).to.equal('.global-test');
        chai_1.expect(meta.outputAst.nodes[2].selector).to.equal('.a .b');
        chai_1.expect(meta.outputAst.nodes[3].selector).to.equal('.c .d');
        chai_1.expect(meta.outputAst.nodes[4].selector).to.equal('.e');
        chai_1.expect(meta.outputAst.nodes[5].selector).to.equal('.style--mixIntoMe');
        chai_1.expect(meta.outputAst.nodes[6].selector).to.equal('.style--mixIntoMe .global-test2');
    });
});
//# sourceMappingURL=global.spec.js.map