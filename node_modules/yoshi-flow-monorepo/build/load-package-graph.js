"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
const import_cwd_1 = __importDefault(require("import-cwd"));
const lodash_1 = require("lodash");
const loadConfig_1 = __importDefault(require("yoshi-config/loadConfig"));
async function loadPackageGraph(monorepoRoot = process.cwd()) {
    const { getPackages } = import_cwd_1.default('@lerna/project');
    const PackageGraph = import_cwd_1.default('@lerna/package-graph');
    const pkgs = await getPackages(monorepoRoot);
    const graph = new PackageGraph(pkgs);
    graph.forEach((node) => {
        node.config = loadConfig_1.default({ cwd: node.location });
    });
    const pkgsArray = Array.from(graph.values());
    const [apps, libs] = lodash_1.partition(pkgsArray, node => node.config.projectType === 'app');
    return { graph, apps, libs };
}
exports.default = loadPackageGraph;
//# sourceMappingURL=load-package-graph.js.map